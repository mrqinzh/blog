(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-646cc50a"],{2423:function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"e",(function(){return l})),a.d(e,"a",(function(){return o})),a.d(e,"c",(function(){return c})),a.d(e,"d",(function(){return n}));a("b4fb");var r=a("b775");function i(t){return Object(r["a"])({url:"/article/".concat(t),method:"delete"})}function l(t){return Object(r["a"])({url:"/article/update",method:"post",data:t})}function o(t){return Object(r["a"])({url:"/article/add",method:"post",data:t})}function c(t){var e="/article/".concat(t);return Object(r["a"])({url:e,method:"get"})}function n(t,e,a){var i="/article/list?currentPage=".concat(t,"&pageSize=").concat(e,"&condition=").concat(a);return Object(r["a"])({url:i,method:"get"})}},3963:function(t,e,a){},"653e":function(t,e,a){},"877a":function(t,e,a){"use strict";a("3963")},b795:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"animate__animated animate__fadeIn"},[a("div",[t._v(" 文章标题："),a("el-input",{staticStyle:{width:"500px"},attrs:{maxlength:40,placeholder:"请输入标题...","show-word-limit":""},model:{value:t.articleForm.articleTitle,callback:function(e){t.$set(t.articleForm,"articleTitle",e)},expression:"articleForm.articleTitle"}}),a("div",{staticStyle:{float:"right"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){""!=t.articleForm.articleTitle&&""!=t.articleForm.articleContentMd?t.showArticleForm=!0:t.$message.warning("标题和内容均不能为空哦，不然还有什么保存的意义！ ！！")}}},[t._v("保存发布")])],1)],1),a("div",{staticClass:"markdown_body"},[a("mavon-editor",{ref:"md",staticStyle:{"min-height":"700px"},attrs:{ishljs:!0},on:{save:t.saveBlog,change:t.change,imgAdd:t.uploadImg,imgDel:t.imgDel},model:{value:t.articleForm.articleContentMd,callback:function(e){t.$set(t.articleForm,"articleContentMd",e)},expression:"articleForm.articleContentMd"}})],1),a("el-dialog",{attrs:{title:"文章发布",visible:t.showArticleForm,"modal-append-to-body":!1},on:{"update:visible":function(e){t.showArticleForm=e}}},[a("el-form",{attrs:{model:t.articleForm}},[a("el-form-item",{attrs:{label:"文章标签","label-width":"120px"}},[a("el-select",{attrs:{multiple:"","multiple-limit":4,placeholder:"请选择文章标签"},model:{value:t.articleForm.articleTag,callback:function(e){t.$set(t.articleForm,"articleTag",e)},expression:"articleForm.articleTag"}},t._l(t.tagList,(function(t,e){return a("el-option",{key:e,attrs:{label:t.tagName,value:t.tagName}})})),1)],1),a("el-form-item",{attrs:{label:"文章类型","label-width":"120px"}},[a("el-radio-group",{model:{value:t.articleForm.articleType,callback:function(e){t.$set(t.articleForm,"articleType",e)},expression:"articleForm.articleType"}},[a("el-radio",{attrs:{label:"原创"}}),a("el-radio",{attrs:{label:"转载"}})],1)],1),a("el-form-item",{attrs:{label:"文章封面图","label-width":"120px"}},[a("img-upload",{attrs:{img:t.articleForm.articleCoverImg},on:{uploadimg:t.coverImgUpload}}),a("el-alert",{attrs:{title:"如果不上传图片的话，系统会随机再你选择的标签中，生成一张对应的图片哦。^_^",type:"success",closable:!1}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.showArticleForm=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.saveBlog}},[t._v("确 定")])],1)],1)],1)},i=[],l=(a("e18c"),a("1c2e"),a("77ad"),a("e35a"),a("0d7a"),a("e112")),o=a("bd49"),c=(a("ec8a"),a("85e0"),a("08ba"),a("6e6d")),n=a("ba96"),s=a.n(n);a("456f");c["default"].directive("highlight",(function(t){var e=t.querySelectorAll("pre code");e.forEach((function(t){s.a.highlightBlock(t)}))}));var u=a("d28d"),d=a("b775");function m(t){return Object(d["a"])({method:"post",url:"/file/qiniu",data:t,headers:{"Content-Type":"multipart/form-data"}})}var g=a("2423"),h={name:"ArticleAdd",components:{ImgUpload:l["a"],mavonEditor:o["mavonEditor"]},data:function(){return{articleHtml:"",tagList:[],showArticleForm:!1,articleForm:{id:"",articleTitle:"",articleSummary:"",articleContentMd:"",articleTag:[],articleType:"原创",articleCoverImg:""}}},methods:{change:function(t,e){this.articleForm.articleContentMd=t,this.articleHtml=e,this.$store.dispatch("article/setContent",t)},saveBlog:function(){var t=this,e={id:this.articleForm.id,articleTitle:this.articleForm.articleTitle,articleSummary:this.articleHtml.substring(0,200),articleCoverImg:this.articleForm.articleCoverImg,articleContentMd:this.articleForm.articleContentMd,articleTag:this.articleForm.articleTag.toString(),articleType:this.articleForm.articleType};this.articleForm.id?(console.log("update"),Object(g["e"])(e).then((function(e){e.success?(t.$message.success("恭喜恭喜，保存成功了。 => ^_^"),t.$notify({title:"通知",dangerouslyUseHTMLString:!0,duration:0,message:'<strong>更新成功了，快去看看把<a href="/" target="_blank">点击前往</a></strong>'}),t.showArticleForm=!1):t.$message.error("保存失败")}))):(console.log("add"),Object(g["a"])(e).then((function(e){e.success?(t.$message.success("恭喜恭喜，保存成功了。 => ^_^"),t.$notify({title:"通知",dangerouslyUseHTMLString:!0,duration:0,message:'<strong>有新文章添加了，快去看看把<a href="/" target="_blank">点击前往</a></strong>'}),t.showArticleForm=!1):t.$message.error("保存失败")})))},uploadImg:function(t,e){var a=this,r=new FormData;r.append("file",e),m(r).then((function(e){e.success&&a.$refs.md.$img2Url(t,e.data)}))},imgDel:function(t){var e=t[0].slice(37);console.log(e)},initUpdateData:function(){var t=this;Object(g["c"])(this.articleForm.id).then((function(e){t.articleForm.articleTitle=e.data.articleTitle,t.articleForm.articleContentMd=e.data.articleContentMd,t.articleForm.articleTag=e.data.articleTag.split(","),t.articleForm.articleType=e.data.articleType,t.articleForm.articleCoverImg=e.data.articleCoverImg}))},initTags:function(){var t=this;Object(u["c"])().then((function(e){t.tagList=e.data}))},coverImgUpload:function(t){this.articleForm.articleCoverImg=t.data}},mounted:function(){this.articleForm.id=this.$route.params.articleId,this.initTags(),this.articleForm.id?this.initUpdateData():this.articleForm.articleContentMd=this.$store.state.article.content}},f=h,p=(a("e89d"),a("cba8")),b=Object(p["a"])(f,r,i,!1,null,null,null);e["default"]=b.exports},d28d:function(t,e,a){"use strict";a.d(e,"d",(function(){return i})),a.d(e,"c",(function(){return l})),a.d(e,"b",(function(){return o})),a.d(e,"a",(function(){return c})),a.d(e,"e",(function(){return n}));a("b4fb");var r=a("b775");function i(t,e,a){var i="/tag/page?currentPage=".concat(t,"&pageSize=").concat(e,"&condition=").concat(a);return Object(r["a"])({url:i,method:"get"})}function l(){return Object(r["a"])({url:"/tag/list",method:"get"})}function o(t){var e="/tag/".concat(t);return Object(r["a"])({url:e,method:"get"})}function c(t){return Object(r["a"])({url:"/tag/add",method:"post",data:t})}function n(t){return Object(r["a"])({url:"/tag/update",method:"post",data:t})}},e112:function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-upload",{staticClass:"my-uploader",attrs:{action:t.baseUrl+"/file/qiniu","show-file-list":!1,data:t.upLoadData,headers:t.headers,"on-success":t.upLoadSuccess,"before-upload":t.beforeUpload}},[t.imageUrl?a("img",{staticClass:"width: 100%;height: 100%;",attrs:{src:t.imageUrl}}):a("i",{staticClass:"el-icon-plus my-uploader-icon"})])},i=[],l=a("4360"),o={props:{img:""},data:function(){return{baseUrl:"http://mrqinzh.info:9090",imageUrl:"",upLoadData:{file:""},headers:{token:l["a"].getters.token}}},methods:{upLoadSuccess:function(t){this.imageUrl=t.data,this.$emit("uploadimg",t),this.$message.success("上传成功")},beforeUpload:function(t){var e=t.size/1024/1024<2;return e||this.$message.error("上传图片大小不能超过 2MB!"),e}}},c=o,n=(a("877a"),a("cba8")),s=Object(n["a"])(c,r,i,!1,null,null,null);e["a"]=s.exports},e89d:function(t,e,a){"use strict";a("653e")}}]);